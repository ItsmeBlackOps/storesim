<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>1‚Äì20 Click Challenge (2s Shuffle)</title>
  <style>
    body {
      font-family: serif;
      font-weight: 700;
      background: #1a1a1a;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-image: url('https://r2.fivemanage.com/3OJ3vdwgKeR1XVN7nKo46/asdasdasdasdasdad.webp');
      background-repeat: no-repeat;
      background-size: cover;
      margin: 0;
    }

    #game-container {
      text-align: center;
    }

    #timer {
      font-size: 24px;
      margin-bottom: 10px;
    }

    #info {
      margin-bottom: 15px;
      font-size: 18px;
    }

    #grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      grid-template-rows: repeat(4, 60px);
      grid-gap: 10px;
      justify-content: center;
      margin-bottom: 10px;
      background-color: rgba(0,0,0,0.7);
      padding: 2vw;
      border-radius: 10px;
    }

    .cell {
      width: 60px;
      height: 60px;
      background: #151515;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      user-select: none;
      transition: background 0.3s;
      border-radius: 4px;
    }

    .cell:hover {
      outline: 1px solid #444;
    }

    .cell.selected {
      background: #555;
      color: #888;
      cursor: default;
    }

    #message {
      margin-top: 15px;
      font-size: 18px;
    }

    #restart {
      background: #383838;
      color: rgb(97, 97, 97);
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin-bottom: 10px;
      border-radius: 5px;
    }

    #restart:hover {
      background: #ffffff;
    }

    #progress-container {
      width: 400px;
      height: 20px;
      background: #444;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px auto;
    }

    #progress-bar {
      height: 100%;
      width: 100%;
      background-color: limegreen;
      transition: width 1.0s linear;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div id="info">
      <span id="timer">Time: 25.0 s</span>
      &nbsp;|&nbsp;
      <span id="target">Next: 1</span>
    </div>

    <div id="grid"></div>

    <button id="restart" onclick="location.reload()">Restart</button>

    <div id="progress-container">
      <div id="progress-bar"></div>
    </div>

    <div id="message"></div>
  </div>

  <script>
    const PENALTY    = 1.5;
    const START_TIME = 25.0;
    const SHUFFLE_MS = 2000;

    let remaining  = START_TIME;
    let nextNum    = 1;
    let numbers    = [];
    let lastStamp;
    let shuffleID, timerID;

    const gridEl     = document.getElementById('grid');
    const timerEl    = document.getElementById('timer');
    const targetEl   = document.getElementById('target');
    const progressEl = document.getElementById('progress-bar');
    const messageEl  = document.getElementById('message');

    function init() {
      numbers = Array.from({length: 20}, (_, i) => i + 1);
      lastStamp = Date.now();

      renderGrid();
      shuffleID = setInterval(shuffleAndRender, SHUFFLE_MS);
      timerID   = setInterval(tick, 100);
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function shuffleAndRender() {
      shuffle(numbers);
      renderGrid();
    }

    function renderGrid() {
      gridEl.innerHTML = '';
      numbers.forEach(n => {
        const cell = document.createElement('div');
        cell.className = 'cell';

        if (n < nextNum) {
          cell.classList.add('selected');
          cell.textContent = '';
        } else {
          cell.textContent = n;
          cell.addEventListener('click', () => handleClick(n));
        }

        gridEl.appendChild(cell);
      });

      targetEl.textContent = 'Next: ' + nextNum;
    }

    function handleClick(n) {
      if (n === nextNum) {
        nextNum++;
        if (nextNum > 20) {
          endGame(true);
          return;
        }
      } else {
        remaining = Math.max(0, remaining - PENALTY);
      }
      renderGrid();
    }

    function tick() {
      const now = Date.now();
      const dt  = (now - lastStamp) / 1000;
      lastStamp = now;

      remaining -= dt;
      updateTimer();

      if (remaining <= 0) {
        endGame(false);
      }
    }

    function updateTimer() {
      timerEl.textContent = 'Time: ' + remaining.toFixed(1) + ' s';
      const percent = Math.max(0, (remaining / START_TIME) * 100);
      progressEl.style.width = percent + '%';
      progressEl.style.backgroundColor = percent > 50 ? 'limegreen' : (percent > 20 ? 'orange' : 'red');
    }

    function endGame(won) {
      clearInterval(shuffleID);
      clearInterval(timerID);
      messageEl.textContent = won
        ? `üéâ You nailed it! Time left: ${remaining.toFixed(1)} s`
        : `‚è∞ Out of time!`;
    }

    init();
  </script>
</body>
</html>
